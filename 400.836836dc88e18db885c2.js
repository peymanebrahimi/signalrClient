"use strict";(self.webpackChunksignalr_client=self.webpackChunksignalr_client||[]).push([[400],{3400:(lt,V,T)=>{T.r(V),T.d(V,{ChatModule:()=>ut});var n,L=T(8583),z=T(4655),B=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),A=function(n){function t(e,o){var r=this,c=this.constructor.prototype;return(r=n.call(this,e)||this).statusCode=o,r.__proto__=c,r}return B(t,n),t}(Error),F=function(n){function t(e){void 0===e&&(e="A timeout occurred.");var i=this,r=this.constructor.prototype;return(i=n.call(this,e)||this).__proto__=r,i}return B(t,n),t}(Error),O=function(n){function t(e){void 0===e&&(e="An abort occurred.");var i=this,r=this.constructor.prototype;return(i=n.call(this,e)||this).__proto__=r,i}return B(t,n),t}(Error),J=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},K=function(t,e,o){this.statusCode=t,this.statusText=e,this.content=o},X=function(){function n(){}return n.prototype.get=function(t,e){return this.send(J({},e,{method:"GET",url:t}))},n.prototype.post=function(t,e){return this.send(J({},e,{method:"POST",url:t}))},n.prototype.delete=function(t,e){return this.send(J({},e,{method:"DELETE",url:t}))},n.prototype.getCookieString=function(t){return""},n}(),l=(()=>(function(n){n[n.Trace=0]="Trace",n[n.Debug=1]="Debug",n[n.Information=2]="Information",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",n[n.None=6]="None"}(l||(l={})),l))(),q=function(){function n(){}return n.prototype.log=function(t,e){},n.instance=new n,n}(),se=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},m=function(){function n(){}return n.isRequired=function(t,e){if(null==t)throw new Error("The '"+e+"' argument is required.")},n.isNotEmpty=function(t,e){if(!t||t.match(/^\s*$/))throw new Error("The '"+e+"' argument should not be empty.")},n.isIn=function(t,e,o){if(!(t in e))throw new Error("Unknown "+o+" value: "+t+".")},n}(),k=function(){function n(){}return Object.defineProperty(n,"isBrowser",{get:function(){return"object"==typeof window},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isWebWorker",{get:function(){return"object"==typeof self&&"importScripts"in self},enumerable:!0,configurable:!0}),Object.defineProperty(n,"isNode",{get:function(){return!this.isBrowser&&!this.isWebWorker},enumerable:!0,configurable:!0}),n}();function H(n,t){var e="";return G(n)?(e="Binary data of length "+n.byteLength,t&&(e+=". Content: '"+function(n){var t=new Uint8Array(n),e="";return t.forEach(function(o){e+="0x"+(o<16?"0":"")+o.toString(16)+" "}),e.substr(0,e.length-1)}(n)+"'")):"string"==typeof n&&(e="String data of length "+n.length,t&&(e+=". Content: '"+n+"'")),e}function G(n){return n&&"undefined"!=typeof ArrayBuffer&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function Y(n,t,e,o,i,r,c,a,u){return function(n,t,e,o){return new(e||(e=Promise))(function(i,r){function c(s){try{u(o.next(s))}catch(h){r(h)}}function a(s){try{u(o.throw(s))}catch(h){r(h)}}function u(s){s.done?i(s.value):new e(function(h){h(s.value)}).then(c,a)}u((o=o.apply(n,[])).next())})}(this,0,void 0,function(){var s,h,d,g,y,p;return function(n,t){var o,i,r,c,e={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(r=(r=e.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){e.label=s[1];break}if(6===s[0]&&e.label<r[1]){e.label=r[1],r=s;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(s);break}r[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(h){s=[6,h],i=0}finally{o=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}}(this,function(M){switch(M.label){case 0:return h={},i?[4,i()]:[3,2];case 1:(d=M.sent())&&((s={}).Authorization="Bearer "+d,h=s),M.label=2;case 2:return g=D(),h[g[0]]=g[1],n.log(l.Trace,"("+t+" transport) sending data. "+H(r,c)+"."),y=G(r)?"arraybuffer":"text",[4,e.post(o,{content:r,headers:se({},h,u),responseType:y,withCredentials:a})];case 3:return p=M.sent(),n.log(l.Trace,"("+t+" transport) request complete. Response status: "+p.statusCode+"."),[2]}})})}var fe=function(){function n(t,e){this.subject=t,this.observer=e}return n.prototype.dispose=function(){var t=this.subject.observers.indexOf(this.observer);t>-1&&this.subject.observers.splice(t,1),0===this.subject.observers.length&&this.subject.cancelCallback&&this.subject.cancelCallback().catch(function(e){})},n}(),W=function(){function n(t){this.minimumLogLevel=t,this.outputConsole=console}return n.prototype.log=function(t,e){if(t>=this.minimumLogLevel)switch(t){case l.Critical:case l.Error:this.outputConsole.error("["+(new Date).toISOString()+"] "+l[t]+": "+e);break;case l.Warning:this.outputConsole.warn("["+(new Date).toISOString()+"] "+l[t]+": "+e);break;case l.Information:this.outputConsole.info("["+(new Date).toISOString()+"] "+l[t]+": "+e);break;default:this.outputConsole.log("["+(new Date).toISOString()+"] "+l[t]+": "+e)}},n}();function D(){var n="X-SignalR-User-Agent";return k.isNode&&(n="User-Agent"),[n,de("5.0.10",ge(),k.isNode?"NodeJS":"Browser",pe())]}function de(n,t,e,o){var i="Microsoft SignalR/",r=n.split(".");return i+=r[0]+"."+r[1],i+=" ("+n+"; ",i+=t&&""!==t?t+"; ":"Unknown OS; ",i+=""+e,(i+=o?"; "+o:"; Unknown Runtime Version")+")"}function ge(){if(!k.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function pe(){if(k.isNode)return process.versions.node}var be=function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),ye=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},Ce=function(n){function t(e){var o=n.call(this)||this;if(o.logger=e,"undefined"==typeof fetch){var i=require;o.jar=new(i("tough-cookie").CookieJar),o.fetchType=i("node-fetch"),o.fetchType=i("fetch-cookie")(o.fetchType,o.jar),o.abortControllerType=i("abort-controller")}else o.fetchType=fetch.bind(self),o.abortControllerType=AbortController;return o}return be(t,n),t.prototype.send=function(e){return function(n,t,e,o){return new(e||(e=Promise))(function(i,r){function c(s){try{u(o.next(s))}catch(h){r(h)}}function a(s){try{u(o.throw(s))}catch(h){r(h)}}function u(s){s.done?i(s.value):new e(function(h){h(s.value)}).then(c,a)}u((o=o.apply(n,[])).next())})}(this,0,void 0,function(){var o,i,r,a,u,h,d=this;return function(n,t){var o,i,r,c,e={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(r=(r=e.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){e.label=s[1];break}if(6===s[0]&&e.label<r[1]){e.label=r[1],r=s;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(s);break}r[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(h){s=[6,h],i=0}finally{o=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}}(this,function(g){switch(g.label){case 0:if(e.abortSignal&&e.abortSignal.aborted)throw new O;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");o=new this.abortControllerType,e.abortSignal&&(e.abortSignal.onabort=function(){o.abort(),i=new O}),r=null,e.timeout&&(r=setTimeout(function(){o.abort(),d.logger.log(l.Warning,"Timeout from HTTP request."),i=new F},e.timeout)),g.label=1;case 1:return g.trys.push([1,3,4,5]),[4,this.fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:ye({"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},e.headers),method:e.method,mode:"cors",redirect:"manual",signal:o.signal})];case 2:return a=g.sent(),[3,5];case 3:throw u=g.sent(),i||(this.logger.log(l.Warning,"Error from HTTP request. "+u+"."),u);case 4:return r&&clearTimeout(r),e.abortSignal&&(e.abortSignal.onabort=null),[7];case 5:if(!a.ok)throw new A(a.statusText,a.status);return[4,function(n,t){var e;switch(t){case"arraybuffer":e=n.arrayBuffer();break;case"text":e=n.text();break;case"blob":case"document":case"json":throw new Error(t+" is not supported.");default:e=n.text()}return e}(a,e.responseType)];case 6:return h=g.sent(),[2,new K(a.status,a.statusText,h)]}})})},t.prototype.getCookieString=function(e){var o="";return k.isNode&&this.jar&&this.jar.getCookies(e,function(i,r){return o=r.join("; ")}),o},t}(X),ke=function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Te=function(n){function t(e){var o=n.call(this)||this;return o.logger=e,o}return ke(t,n),t.prototype.send=function(e){var o=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new O):e.method?e.url?new Promise(function(i,r){var c=new XMLHttpRequest;c.open(e.method,e.url,!0),c.withCredentials=void 0===e.withCredentials||e.withCredentials,c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var a=e.headers;a&&Object.keys(a).forEach(function(u){c.setRequestHeader(u,a[u])}),e.responseType&&(c.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){c.abort(),r(new O)}),e.timeout&&(c.timeout=e.timeout),c.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),c.status>=200&&c.status<300?i(new K(c.status,c.statusText,c.response||c.responseText)):r(new A(c.statusText,c.status))},c.onerror=function(){o.logger.log(l.Warning,"Error from HTTP request. "+c.status+": "+c.statusText+"."),r(new A(c.statusText,c.status))},c.ontimeout=function(){o.logger.log(l.Warning,"Timeout from HTTP request."),r(new F)},c.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(X),Ee=function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Ie=function(n){function t(e){var o=n.call(this)||this;if("undefined"!=typeof fetch||k.isNode)o.httpClient=new Ce(e);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");o.httpClient=new Te(e)}return o}return Ee(t,n),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new O):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(X),R=function(){function n(){}return n.write=function(t){return""+t+n.RecordSeparator},n.parse=function(t){if(t[t.length-1]!==n.RecordSeparator)throw new Error("Message is incomplete.");var e=t.split(n.RecordSeparator);return e.pop(),e},n.RecordSeparatorCode=30,n.RecordSeparator=String.fromCharCode(n.RecordSeparatorCode),n}(),Pe=function(){function n(){}return n.prototype.writeHandshakeRequest=function(t){return R.write(JSON.stringify(t))},n.prototype.parseHandshakeResponse=function(t){var o,i;if(G(t)||"undefined"!=typeof Buffer&&t instanceof Buffer){var r=new Uint8Array(t);if(-1===(c=r.indexOf(R.RecordSeparatorCode)))throw new Error("Message is incomplete.");var a=c+1;o=String.fromCharCode.apply(null,r.slice(0,a)),i=r.byteLength>a?r.slice(a).buffer:null}else{var c,u=t;if(-1===(c=u.indexOf(R.RecordSeparator)))throw new Error("Message is incomplete.");o=u.substring(0,a=c+1),i=u.length>a?u.substring(a):null}var s=R.parse(o),h=JSON.parse(s[0]);if(h.type)throw new Error("Expected a handshake response from the server.");return[i,h]},n}(),v=(()=>(function(n){n[n.Invocation=1]="Invocation",n[n.StreamItem=2]="StreamItem",n[n.Completion=3]="Completion",n[n.StreamInvocation=4]="StreamInvocation",n[n.CancelInvocation=5]="CancelInvocation",n[n.Ping=6]="Ping",n[n.Close=7]="Close"}(v||(v={})),v))(),xe=function(){function n(){this.observers=[]}return n.prototype.next=function(t){for(var e=0,o=this.observers;e<o.length;e++)o[e].next(t)},n.prototype.error=function(t){for(var e=0,o=this.observers;e<o.length;e++){var i=o[e];i.error&&i.error(t)}},n.prototype.complete=function(){for(var t=0,e=this.observers;t<e.length;t++){var o=e[t];o.complete&&o.complete()}},n.prototype.subscribe=function(t){return this.observers.push(t),new fe(this,t)},n}(),_=function(n,t,e,o){return new(e||(e=Promise))(function(i,r){function c(s){try{u(o.next(s))}catch(h){r(h)}}function a(s){try{u(o.throw(s))}catch(h){r(h)}}function u(s){s.done?i(s.value):new e(function(h){h(s.value)}).then(c,a)}u((o=o.apply(n,t||[])).next())})},j=function(n,t){var o,i,r,c,e={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(r=(r=e.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){e.label=s[1];break}if(6===s[0]&&e.label<r[1]){e.label=r[1],r=s;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(s);break}r[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(h){s=[6,h],i=0}finally{o=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},b=(()=>(function(n){n.Disconnected="Disconnected",n.Connecting="Connecting",n.Connected="Connected",n.Disconnecting="Disconnecting",n.Reconnecting="Reconnecting"}(b||(b={})),b))(),Ae=function(){function n(t,e,o,i){var r=this;this.nextKeepAlive=0,m.isRequired(t,"connection"),m.isRequired(e,"logger"),m.isRequired(o,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.logger=e,this.protocol=o,this.connection=t,this.reconnectPolicy=i,this.handshakeProtocol=new Pe,this.connection.onreceive=function(c){return r.processIncomingData(c)},this.connection.onclose=function(c){return r.connectionClosed(c)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.reconnectingCallbacks=[],this.reconnectedCallbacks=[],this.invocationId=0,this.receivedHandshakeResponse=!1,this.connectionState=b.Disconnected,this.connectionStarted=!1,this.cachedPingMessage=this.protocol.writeMessage({type:v.Ping})}return n.create=function(t,e,o,i){return new n(t,e,o,i)},Object.defineProperty(n.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"connectionId",{get:function(){return this.connection&&this.connection.connectionId||null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"baseUrl",{get:function(){return this.connection.baseUrl||""},set:function(t){if(this.connectionState!==b.Disconnected&&this.connectionState!==b.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!t)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=t},enumerable:!0,configurable:!0}),n.prototype.start=function(){return this.startPromise=this.startWithStateTransitions(),this.startPromise},n.prototype.startWithStateTransitions=function(){return _(this,void 0,void 0,function(){var t;return j(this,function(e){switch(e.label){case 0:if(this.connectionState!==b.Disconnected)return[2,Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."))];this.connectionState=b.Connecting,this.logger.log(l.Debug,"Starting HubConnection."),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.startInternal()];case 2:return e.sent(),this.connectionState=b.Connected,this.connectionStarted=!0,this.logger.log(l.Debug,"HubConnection connected successfully."),[3,4];case 3:return t=e.sent(),this.connectionState=b.Disconnected,this.logger.log(l.Debug,"HubConnection failed to start successfully because of error '"+t+"'."),[2,Promise.reject(t)];case 4:return[2]}})})},n.prototype.startInternal=function(){return _(this,void 0,void 0,function(){var t,e,o,i=this;return j(this,function(r){switch(r.label){case 0:return this.stopDuringStartError=void 0,this.receivedHandshakeResponse=!1,t=new Promise(function(c,a){i.handshakeResolver=c,i.handshakeRejecter=a}),[4,this.connection.start(this.protocol.transferFormat)];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,5,,7]),e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(l.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 3:return r.sent(),this.logger.log(l.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,t];case 4:if(r.sent(),this.stopDuringStartError)throw this.stopDuringStartError;return[3,7];case 5:return o=r.sent(),this.logger.log(l.Debug,"Hub handshake failed with error '"+o+"' during start(). Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),[4,this.connection.stop(o)];case 6:throw r.sent(),o;case 7:return[2]}})})},n.prototype.stop=function(){return _(this,void 0,void 0,function(){var t;return j(this,function(o){switch(o.label){case 0:return t=this.startPromise,this.stopPromise=this.stopInternal(),[4,this.stopPromise];case 1:o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,t];case 3:case 4:return o.sent(),[3,5];case 5:return[2]}})})},n.prototype.stopInternal=function(t){return this.connectionState===b.Disconnected?(this.logger.log(l.Debug,"Call to HubConnection.stop("+t+") ignored because it is already in the disconnected state."),Promise.resolve()):this.connectionState===b.Disconnecting?(this.logger.log(l.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnecting state."),this.stopPromise):(this.connectionState=b.Disconnecting,this.logger.log(l.Debug,"Stopping HubConnection."),this.reconnectDelayHandle?(this.logger.log(l.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this.reconnectDelayHandle),this.reconnectDelayHandle=void 0,this.completeClose(),Promise.resolve()):(this.cleanupTimeout(),this.cleanupPingTimer(),this.stopDuringStartError=t||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(t)))},n.prototype.stream=function(t){for(var e=this,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var s,r=this.replaceStreamingParams(o),c=r[0],a=r[1],u=this.createStreamInvocation(t,o,a),h=new xe;return h.cancelCallback=function(){var d=e.createCancelInvocation(u.invocationId);return delete e.callbacks[u.invocationId],s.then(function(){return e.sendWithProtocol(d)})},this.callbacks[u.invocationId]=function(d,g){g?h.error(g):d&&(d.type===v.Completion?d.error?h.error(new Error(d.error)):h.complete():h.next(d.item))},s=this.sendWithProtocol(u).catch(function(d){h.error(d),delete e.callbacks[u.invocationId]}),this.launchStreams(c,s),h},n.prototype.sendMessage=function(t){return this.resetKeepAliveInterval(),this.connection.send(t)},n.prototype.sendWithProtocol=function(t){return this.sendMessage(this.protocol.writeMessage(t))},n.prototype.send=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var i=this.replaceStreamingParams(e),r=i[0],c=i[1],a=this.sendWithProtocol(this.createInvocation(t,e,!0,c));return this.launchStreams(r,a),a},n.prototype.invoke=function(t){for(var e=this,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var r=this.replaceStreamingParams(o),c=r[0],a=r[1],u=this.createInvocation(t,o,!1,a),s=new Promise(function(h,d){e.callbacks[u.invocationId]=function(C,E){E?d(E):C&&(C.type===v.Completion?C.error?d(new Error(C.error)):h(C.result):d(new Error("Unexpected message type: "+C.type)))};var g=e.sendWithProtocol(u).catch(function(C){d(C),delete e.callbacks[u.invocationId]});e.launchStreams(c,g)});return s},n.prototype.on=function(t,e){!t||!e||(t=t.toLowerCase(),this.methods[t]||(this.methods[t]=[]),-1===this.methods[t].indexOf(e)&&this.methods[t].push(e))},n.prototype.off=function(t,e){if(t){t=t.toLowerCase();var o=this.methods[t];if(o)if(e){var i=o.indexOf(e);-1!==i&&(o.splice(i,1),0===o.length&&delete this.methods[t])}else delete this.methods[t]}},n.prototype.onclose=function(t){t&&this.closedCallbacks.push(t)},n.prototype.onreconnecting=function(t){t&&this.reconnectingCallbacks.push(t)},n.prototype.onreconnected=function(t){t&&this.reconnectedCallbacks.push(t)},n.prototype.processIncomingData=function(t){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(t=this.processHandshakeResponse(t),this.receivedHandshakeResponse=!0),t)for(var o=0,i=this.protocol.parseMessages(t,this.logger);o<i.length;o++){var r=i[o];switch(r.type){case v.Invocation:this.invokeClientMethod(r);break;case v.StreamItem:case v.Completion:var c=this.callbacks[r.invocationId];c&&(r.type===v.Completion&&delete this.callbacks[r.invocationId],c(r));break;case v.Ping:break;case v.Close:this.logger.log(l.Information,"Close message received from server.");var a=r.error?new Error("Server returned an error on close: "+r.error):void 0;!0===r.allowReconnect?this.connection.stop(a):this.stopPromise=this.stopInternal(a);break;default:this.logger.log(l.Warning,"Invalid message type: "+r.type+".")}}this.resetTimeoutPeriod()},n.prototype.processHandshakeResponse=function(t){var e,o,i,r;try{i=(e=this.handshakeProtocol.parseHandshakeResponse(t))[0],o=e[1]}catch(a){this.logger.log(l.Error,r="Error parsing handshake response: "+a);var c=new Error(r);throw this.handshakeRejecter(c),c}if(o.error)throw this.logger.log(l.Error,r="Server returned handshake error: "+o.error),c=new Error(r),this.handshakeRejecter(c),c;return this.logger.log(l.Debug,"Server handshake complete."),this.handshakeResolver(),i},n.prototype.resetKeepAliveInterval=function(){this.connection.features.inherentKeepAlive||(this.nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this.cleanupPingTimer())},n.prototype.resetTimeoutPeriod=function(){var t=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return t.serverTimeout()},this.serverTimeoutInMilliseconds),void 0!==this.pingServerHandle))){var e=this.nextKeepAlive-(new Date).getTime();e<0&&(e=0),this.pingServerHandle=setTimeout(function(){return _(t,void 0,void 0,function(){return j(this,function(i){switch(i.label){case 0:if(this.connectionState!==b.Connected)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return i.sent(),[3,4];case 3:return i.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},e)}},n.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},n.prototype.invokeClientMethod=function(t){var e=this,o=this.methods[t.target.toLowerCase()];if(o){try{o.forEach(function(r){return r.apply(e,t.arguments)})}catch(r){this.logger.log(l.Error,"A callback for the method "+t.target.toLowerCase()+" threw error '"+r+"'.")}if(t.invocationId){var i="Server requested a response, which is not supported in this version of the client.";this.logger.log(l.Error,i),this.stopPromise=this.stopInternal(new Error(i))}}else this.logger.log(l.Warning,"No client method with the name '"+t.target+"' found.")},n.prototype.connectionClosed=function(t){this.logger.log(l.Debug,"HubConnection.connectionClosed("+t+") called while in state "+this.connectionState+"."),this.stopDuringStartError=this.stopDuringStartError||t||new Error("The underlying connection was closed before the hub handshake could complete."),this.handshakeResolver&&this.handshakeResolver(),this.cancelCallbacksWithError(t||new Error("Invocation canceled due to the underlying connection being closed.")),this.cleanupTimeout(),this.cleanupPingTimer(),this.connectionState===b.Disconnecting?this.completeClose(t):this.connectionState===b.Connected&&this.reconnectPolicy?this.reconnect(t):this.connectionState===b.Connected&&this.completeClose(t)},n.prototype.completeClose=function(t){var e=this;if(this.connectionStarted){this.connectionState=b.Disconnected,this.connectionStarted=!1;try{this.closedCallbacks.forEach(function(o){return o.apply(e,[t])})}catch(o){this.logger.log(l.Error,"An onclose callback called with error '"+t+"' threw error '"+o+"'.")}}},n.prototype.reconnect=function(t){return _(this,void 0,void 0,function(){var e,o,i,r,c,a=this;return j(this,function(u){switch(u.label){case 0:if(e=Date.now(),o=0,i=void 0!==t?t:new Error("Attempting to reconnect due to a unknown error."),null===(r=this.getNextRetryDelay(o++,0,i)))return this.logger.log(l.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this.completeClose(t),[2];if(this.connectionState=b.Reconnecting,this.logger.log(l.Information,t?"Connection reconnecting because of error '"+t+"'.":"Connection reconnecting."),this.onreconnecting){try{this.reconnectingCallbacks.forEach(function(s){return s.apply(a,[t])})}catch(s){this.logger.log(l.Error,"An onreconnecting callback called with error '"+t+"' threw error '"+s+"'.")}if(this.connectionState!==b.Reconnecting)return this.logger.log(l.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting."),[2]}u.label=1;case 1:return null===r?[3,7]:(this.logger.log(l.Information,"Reconnect attempt number "+o+" will start in "+r+" ms."),[4,new Promise(function(s){a.reconnectDelayHandle=setTimeout(s,r)})]);case 2:if(u.sent(),this.reconnectDelayHandle=void 0,this.connectionState!==b.Reconnecting)return this.logger.log(l.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting."),[2];u.label=3;case 3:return u.trys.push([3,5,,6]),[4,this.startInternal()];case 4:if(u.sent(),this.connectionState=b.Connected,this.logger.log(l.Information,"HubConnection reconnected successfully."),this.onreconnected)try{this.reconnectedCallbacks.forEach(function(s){return s.apply(a,[a.connection.connectionId])})}catch(s){this.logger.log(l.Error,"An onreconnected callback called with connectionId '"+this.connection.connectionId+"; threw error '"+s+"'.")}return[2];case 5:return c=u.sent(),this.logger.log(l.Information,"Reconnect attempt failed because of error '"+c+"'."),this.connectionState!==b.Reconnecting?(this.logger.log(l.Debug,"Connection moved to the '"+this.connectionState+"' from the reconnecting state during reconnect attempt. Done reconnecting."),this.connectionState===b.Disconnecting&&this.completeClose(),[2]):(i=c instanceof Error?c:new Error(c.toString()),r=this.getNextRetryDelay(o++,Date.now()-e,i),[3,6]);case 6:return[3,1];case 7:return this.logger.log(l.Information,"Reconnect retries have been exhausted after "+(Date.now()-e)+" ms and "+o+" failed attempts. Connection disconnecting."),this.completeClose(),[2]}})})},n.prototype.getNextRetryDelay=function(t,e,o){try{return this.reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:e,previousRetryCount:t,retryReason:o})}catch(i){return this.logger.log(l.Error,"IRetryPolicy.nextRetryDelayInMilliseconds("+t+", "+e+") threw error '"+i+"'."),null}},n.prototype.cancelCallbacksWithError=function(t){var e=this.callbacks;this.callbacks={},Object.keys(e).forEach(function(o){(0,e[o])(null,t)})},n.prototype.cleanupPingTimer=function(){this.pingServerHandle&&(clearTimeout(this.pingServerHandle),this.pingServerHandle=void 0)},n.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},n.prototype.createInvocation=function(t,e,o,i){if(o)return 0!==i.length?{arguments:e,streamIds:i,target:t,type:v.Invocation}:{arguments:e,target:t,type:v.Invocation};var r=this.invocationId;return this.invocationId++,0!==i.length?{arguments:e,invocationId:r.toString(),streamIds:i,target:t,type:v.Invocation}:{arguments:e,invocationId:r.toString(),target:t,type:v.Invocation}},n.prototype.launchStreams=function(t,e){var o=this;if(0!==t.length){e||(e=Promise.resolve());var i=function(c){t[c].subscribe({complete:function(){e=e.then(function(){return o.sendWithProtocol(o.createCompletionMessage(c))})},error:function(a){var u;u=a instanceof Error?a.message:a&&a.toString?a.toString():"Unknown error",e=e.then(function(){return o.sendWithProtocol(o.createCompletionMessage(c,u))})},next:function(a){e=e.then(function(){return o.sendWithProtocol(o.createStreamItemMessage(c,a))})}})};for(var r in t)i(r)}},n.prototype.replaceStreamingParams=function(t){for(var e=[],o=[],i=0;i<t.length;i++){var r=t[i];if(this.isObservable(r)){var c=this.invocationId;this.invocationId++,e[c]=r,o.push(c.toString()),t.splice(i,1)}}return[e,o]},n.prototype.isObservable=function(t){return t&&t.subscribe&&"function"==typeof t.subscribe},n.prototype.createStreamInvocation=function(t,e,o){var i=this.invocationId;return this.invocationId++,0!==o.length?{arguments:e,invocationId:i.toString(),streamIds:o,target:t,type:v.StreamInvocation}:{arguments:e,invocationId:i.toString(),target:t,type:v.StreamInvocation}},n.prototype.createCancelInvocation=function(t){return{invocationId:t,type:v.CancelInvocation}},n.prototype.createStreamItemMessage=function(t,e){return{invocationId:t,item:e,type:v.StreamItem}},n.prototype.createCompletionMessage=function(t,e,o){return e?{error:e,invocationId:t,type:v.Completion}:{invocationId:t,result:o,type:v.Completion}},n}(),Oe=[0,2e3,1e4,3e4,null],$=function(){function n(t){this.retryDelays=void 0!==t?t.concat([null]):Oe}return n.prototype.nextRetryDelayInMilliseconds=function(t){return this.retryDelays[t.previousRetryCount]},n}(),w=(()=>(function(n){n[n.None=0]="None",n[n.WebSockets=1]="WebSockets",n[n.ServerSentEvents=2]="ServerSentEvents",n[n.LongPolling=4]="LongPolling"}(w||(w={})),w))(),S=(()=>(function(n){n[n.Text=1]="Text",n[n.Binary=2]="Binary"}(S||(S={})),S))(),He=function(){function n(){this.isAborted=!1,this.onabort=null}return n.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(n.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),n}(),ee=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},U=function(n,t,e,o){return new(e||(e=Promise))(function(i,r){function c(s){try{u(o.next(s))}catch(h){r(h)}}function a(s){try{u(o.throw(s))}catch(h){r(h)}}function u(s){s.done?i(s.value):new e(function(h){h(s.value)}).then(c,a)}u((o=o.apply(n,t||[])).next())})},N=function(n,t){var o,i,r,c,e={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(r=(r=e.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){e.label=s[1];break}if(6===s[0]&&e.label<r[1]){e.label=r[1],r=s;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(s);break}r[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(h){s=[6,h],i=0}finally{o=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},te=function(){function n(t,e,o,i,r,c){this.httpClient=t,this.accessTokenFactory=e,this.logger=o,this.pollAbort=new He,this.logMessageContent=i,this.withCredentials=r,this.headers=c,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(n.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),n.prototype.connect=function(t,e){return U(this,void 0,void 0,function(){var o,i,a,u,s,h,d;return N(this,function(g){switch(g.label){case 0:if(m.isRequired(t,"url"),m.isRequired(e,"transferFormat"),m.isIn(e,S,"transferFormat"),this.url=t,this.logger.log(l.Trace,"(LongPolling transport) Connecting."),e===S.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return i=D(),a=ee(((o={})[i[0]]=i[1],o),this.headers),u={abortSignal:this.pollAbort.signal,headers:a,timeout:1e5,withCredentials:this.withCredentials},e===S.Binary&&(u.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return s=g.sent(),this.updateHeaderToken(u,s),h=t+"&_="+Date.now(),this.logger.log(l.Trace,"(LongPolling transport) polling: "+h+"."),[4,this.httpClient.get(h,u)];case 2:return 200!==(d=g.sent()).statusCode?(this.logger.log(l.Error,"(LongPolling transport) Unexpected response code: "+d.statusCode+"."),this.closeError=new A(d.statusText||"",d.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,u),[2]}})})},n.prototype.getAccessToken=function(){return U(this,void 0,void 0,function(){return N(this,function(t){switch(t.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,null]}})})},n.prototype.updateHeaderToken=function(t,e){t.headers||(t.headers={}),e?t.headers.Authorization="Bearer "+e:t.headers.Authorization&&delete t.headers.Authorization},n.prototype.poll=function(t,e){return U(this,void 0,void 0,function(){var o,i,r,c;return N(this,function(a){switch(a.label){case 0:a.trys.push([0,,8,9]),a.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:o=a.sent(),this.updateHeaderToken(e,o),a.label=3;case 3:return a.trys.push([3,5,,6]),i=t+"&_="+Date.now(),this.logger.log(l.Trace,"(LongPolling transport) polling: "+i+"."),[4,this.httpClient.get(i,e)];case 4:return 204===(r=a.sent()).statusCode?(this.logger.log(l.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==r.statusCode?(this.logger.log(l.Error,"(LongPolling transport) Unexpected response code: "+r.statusCode+"."),this.closeError=new A(r.statusText||"",r.statusCode),this.running=!1):r.content?(this.logger.log(l.Trace,"(LongPolling transport) data received. "+H(r.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(r.content)):this.logger.log(l.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return c=a.sent(),this.running?c instanceof F?this.logger.log(l.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=c,this.running=!1):this.logger.log(l.Trace,"(LongPolling transport) Poll errored after shutdown: "+c.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(l.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},n.prototype.send=function(t){return U(this,void 0,void 0,function(){return N(this,function(e){return this.running?[2,Y(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},n.prototype.stop=function(){return U(this,void 0,void 0,function(){var t,e,r,c;return N(this,function(a){switch(a.label){case 0:this.logger.log(l.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),a.label=1;case 1:return a.trys.push([1,,5,6]),[4,this.receiving];case 2:return a.sent(),this.logger.log(l.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),t={},e=D(),t[e[0]]=e[1],r={headers:ee({},t,this.headers),withCredentials:this.withCredentials},[4,this.getAccessToken()];case 3:return c=a.sent(),this.updateHeaderToken(r,c),[4,this.httpClient.delete(this.url,r)];case 4:return a.sent(),this.logger.log(l.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(l.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},n.prototype.raiseOnClose=function(){if(this.onclose){var t="(LongPolling transport) Firing onclose event.";this.closeError&&(t+=" Error: "+this.closeError),this.logger.log(l.Trace,t),this.onclose(this.closeError)}},n}(),_e=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},ne=function(n,t,e,o){return new(e||(e=Promise))(function(i,r){function c(s){try{u(o.next(s))}catch(h){r(h)}}function a(s){try{u(o.throw(s))}catch(h){r(h)}}function u(s){s.done?i(s.value):new e(function(h){h(s.value)}).then(c,a)}u((o=o.apply(n,t||[])).next())})},re=function(n,t){var o,i,r,c,e={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(r=(r=e.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){e.label=s[1];break}if(6===s[0]&&e.label<r[1]){e.label=r[1],r=s;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(s);break}r[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(h){s=[6,h],i=0}finally{o=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},je=function(){function n(t,e,o,i,r,c,a){this.httpClient=t,this.accessTokenFactory=e,this.logger=o,this.logMessageContent=i,this.withCredentials=c,this.eventSourceConstructor=r,this.headers=a,this.onreceive=null,this.onclose=null}return n.prototype.connect=function(t,e){return ne(this,void 0,void 0,function(){var o,i=this;return re(this,function(r){switch(r.label){case 0:return m.isRequired(t,"url"),m.isRequired(e,"transferFormat"),m.isIn(e,S,"transferFormat"),this.logger.log(l.Trace,"(SSE transport) Connecting."),this.url=t,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(o=r.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(o)),r.label=2;case 2:return[2,new Promise(function(c,a){var u=!1;if(e===S.Text){var s;if(k.isBrowser||k.isWebWorker)s=new i.eventSourceConstructor(t,{withCredentials:i.withCredentials});else{var h=i.httpClient.getCookieString(t),d={};d.Cookie=h;var g=D();d[g[0]]=g[1],s=new i.eventSourceConstructor(t,{withCredentials:i.withCredentials,headers:_e({},d,i.headers)})}try{s.onmessage=function(y){if(i.onreceive)try{i.logger.log(l.Trace,"(SSE transport) data received. "+H(y.data,i.logMessageContent)+"."),i.onreceive(y.data)}catch(p){return void i.close(p)}},s.onerror=function(y){var p=new Error(y.data||"Error occurred");u?i.close(p):a(p)},s.onopen=function(){i.logger.log(l.Information,"SSE connected to "+i.url),i.eventSource=s,u=!0,c()}}catch(y){return void a(y)}}else a(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},n.prototype.send=function(t){return ne(this,void 0,void 0,function(){return re(this,function(e){return this.eventSource?[2,Y(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,t,this.logMessageContent,this.withCredentials,this.headers)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},n.prototype.stop=function(){return this.close(),Promise.resolve()},n.prototype.close=function(t){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(t))},n}(),Ue=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},Ze=function(){function n(t,e,o,i,r,c){this.logger=o,this.accessTokenFactory=e,this.logMessageContent=i,this.webSocketConstructor=r,this.httpClient=t,this.onreceive=null,this.onclose=null,this.headers=c}return n.prototype.connect=function(t,e){return function(n,t,e,o){return new(e||(e=Promise))(function(i,r){function c(s){try{u(o.next(s))}catch(h){r(h)}}function a(s){try{u(o.throw(s))}catch(h){r(h)}}function u(s){s.done?i(s.value):new e(function(h){h(s.value)}).then(c,a)}u((o=o.apply(n,[])).next())})}(this,0,void 0,function(){var o,i=this;return function(n,t){var o,i,r,c,e={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(r=(r=e.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){e.label=s[1];break}if(6===s[0]&&e.label<r[1]){e.label=r[1],r=s;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(s);break}r[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(h){s=[6,h],i=0}finally{o=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}}(this,function(r){switch(r.label){case 0:return m.isRequired(t,"url"),m.isRequired(e,"transferFormat"),m.isIn(e,S,"transferFormat"),this.logger.log(l.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(o=r.sent())&&(t+=(t.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(o)),r.label=2;case 2:return[2,new Promise(function(c,a){t=t.replace(/^http/,"ws");var u,s=i.httpClient.getCookieString(t),h=!1;if(k.isNode){var d={},g=D();d[g[0]]=g[1],s&&(d.Cookie=""+s),u=new i.webSocketConstructor(t,void 0,{headers:Ue({},d,i.headers)})}u||(u=new i.webSocketConstructor(t)),e===S.Binary&&(u.binaryType="arraybuffer"),u.onopen=function(y){i.logger.log(l.Information,"WebSocket connected to "+t+"."),i.webSocket=u,h=!0,c()},u.onerror=function(y){var p;p="undefined"!=typeof ErrorEvent&&y instanceof ErrorEvent?y.error:new Error("There was an error with the transport."),a(p)},u.onmessage=function(y){if(i.logger.log(l.Trace,"(WebSockets transport) data received. "+H(y.data,i.logMessageContent)+"."),i.onreceive)try{i.onreceive(y.data)}catch(p){return void i.close(p)}},u.onclose=function(y){if(h)i.close(y);else{var p;p="undefined"!=typeof ErrorEvent&&y instanceof ErrorEvent?y.error:new Error("There was an error with the transport."),a(p)}}})]}})})},n.prototype.send=function(t){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(l.Trace,"(WebSockets transport) sending data. "+H(t,this.logMessageContent)+"."),this.webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},n.prototype.stop=function(){return this.webSocket&&this.close(void 0),Promise.resolve()},n.prototype.close=function(t){this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0),this.logger.log(l.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this.isCloseEvent(t)||!1!==t.wasClean&&1e3===t.code?t instanceof Error?this.onclose(t):this.onclose():this.onclose(new Error("WebSocket closed with status code: "+t.code+" ("+t.reason+").")))},n.prototype.isCloseEvent=function(t){return t&&"boolean"==typeof t.wasClean&&"number"==typeof t.code},n}(),Me=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},x=function(n,t,e,o){return new(e||(e=Promise))(function(i,r){function c(s){try{u(o.next(s))}catch(h){r(h)}}function a(s){try{u(o.throw(s))}catch(h){r(h)}}function u(s){s.done?i(s.value):new e(function(h){h(s.value)}).then(c,a)}u((o=o.apply(n,t||[])).next())})},P=function(n,t){var o,i,r,c,e={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(s){return function(h){return function(s){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(!(r=(r=e.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){e=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){e.label=s[1];break}if(6===s[0]&&e.label<r[1]){e.label=r[1],r=s;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(s);break}r[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(h){s=[6,h],i=0}finally{o=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,h])}}},Le=function(){function n(t,e){if(void 0===e&&(e={}),this.stopPromiseResolver=function(){},this.features={},this.negotiateVersion=1,m.isRequired(t,"url"),this.logger=function(n){return void 0===n?new W(l.Information):null===n?q.instance:n.log?n:new W(n)}(e.logger),this.baseUrl=this.resolveUrl(t),(e=e||{}).logMessageContent=void 0!==e.logMessageContent&&e.logMessageContent,"boolean"!=typeof e.withCredentials&&void 0!==e.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");e.withCredentials=void 0===e.withCredentials||e.withCredentials;var o=null,i=null;if(k.isNode){var r=require;o=r("ws"),i=r("eventsource")}k.isNode||"undefined"==typeof WebSocket||e.WebSocket?k.isNode&&!e.WebSocket&&o&&(e.WebSocket=o):e.WebSocket=WebSocket,k.isNode||"undefined"==typeof EventSource||e.EventSource?k.isNode&&!e.EventSource&&void 0!==i&&(e.EventSource=i):e.EventSource=EventSource,this.httpClient=e.httpClient||new Ie(this.logger),this.connectionState="Disconnected",this.connectionStarted=!1,this.options=e,this.onreceive=null,this.onclose=null}return n.prototype.start=function(t){return x(this,void 0,void 0,function(){var e;return P(this,function(o){switch(o.label){case 0:return m.isIn(t=t||S.Binary,S,"transferFormat"),this.logger.log(l.Debug,"Starting connection with transfer format '"+S[t]+"'."),"Disconnected"!==this.connectionState?[2,Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."))]:(this.connectionState="Connecting",this.startInternalPromise=this.startInternal(t),[4,this.startInternalPromise]);case 1:return o.sent(),"Disconnecting"!==this.connectionState?[3,3]:(this.logger.log(l.Error,e="Failed to start the HttpConnection before stop() was called."),[4,this.stopPromise]);case 2:return o.sent(),[2,Promise.reject(new Error(e))];case 3:if("Connected"!==this.connectionState)return this.logger.log(l.Error,e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!"),[2,Promise.reject(new Error(e))];o.label=4;case 4:return this.connectionStarted=!0,[2]}})})},n.prototype.send=function(t){return"Connected"!==this.connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this.sendQueue||(this.sendQueue=new Fe(this.transport)),this.sendQueue.send(t))},n.prototype.stop=function(t){return x(this,void 0,void 0,function(){var e=this;return P(this,function(o){switch(o.label){case 0:return"Disconnected"===this.connectionState?(this.logger.log(l.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnected state."),[2,Promise.resolve()]):"Disconnecting"===this.connectionState?(this.logger.log(l.Debug,"Call to HttpConnection.stop("+t+") ignored because the connection is already in the disconnecting state."),[2,this.stopPromise]):(this.connectionState="Disconnecting",this.stopPromise=new Promise(function(i){e.stopPromiseResolver=i}),[4,this.stopInternal(t)]);case 1:return o.sent(),[4,this.stopPromise];case 2:return o.sent(),[2]}})})},n.prototype.stopInternal=function(t){return x(this,void 0,void 0,function(){var o;return P(this,function(i){switch(i.label){case 0:this.stopError=t,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.startInternalPromise];case 2:case 3:return i.sent(),[3,4];case 4:if(!this.transport)return[3,9];i.label=5;case 5:return i.trys.push([5,7,,8]),[4,this.transport.stop()];case 6:return i.sent(),[3,8];case 7:return o=i.sent(),this.logger.log(l.Error,"HttpConnection.transport.stop() threw error '"+o+"'."),this.stopConnection(),[3,8];case 8:return this.transport=void 0,[3,10];case 9:this.logger.log(l.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed."),i.label=10;case 10:return[2]}})})},n.prototype.startInternal=function(t){return x(this,void 0,void 0,function(){var e,o,i,r,c,a;return P(this,function(u){switch(u.label){case 0:e=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,u.label=1;case 1:return u.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==w.WebSockets?[3,3]:(this.transport=this.constructTransport(w.WebSockets),[4,this.startTransport(e,t)]):[3,5];case 2:return u.sent(),[3,4];case 3:throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:o=null,i=0,r=function(){var s;return P(this,function(h){switch(h.label){case 0:return[4,c.getNegotiationResponse(e)];case 1:if(o=h.sent(),"Disconnecting"===c.connectionState||"Disconnected"===c.connectionState)throw new Error("The connection was stopped during negotiation.");if(o.error)throw new Error(o.error);if(o.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return o.url&&(e=o.url),o.accessToken&&(s=o.accessToken,c.accessTokenFactory=function(){return s}),i++,[2]}})},c=this,u.label=6;case 6:return[5,r()];case 7:u.sent(),u.label=8;case 8:if(o.url&&i<100)return[3,6];u.label=9;case 9:if(100===i&&o.url)throw new Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(e,this.options.transport,o,t)];case 10:u.sent(),u.label=11;case 11:return this.transport instanceof te&&(this.features.inherentKeepAlive=!0),"Connecting"===this.connectionState&&(this.logger.log(l.Debug,"The HttpConnection connected successfully."),this.connectionState="Connected"),[3,13];case 12:return a=u.sent(),this.logger.log(l.Error,"Failed to start the connection: "+a),this.connectionState="Disconnected",this.transport=void 0,this.stopPromiseResolver(),[2,Promise.reject(a)];case 13:return[2]}})})},n.prototype.getNegotiationResponse=function(t){return x(this,void 0,void 0,function(){var e,o,i,a,u,s,h;return P(this,function(d){switch(d.label){case 0:return e={},this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(o=d.sent())&&(e.Authorization="Bearer "+o),d.label=2;case 2:i=D(),e[i[0]]=i[1],a=this.resolveNegotiateUrl(t),this.logger.log(l.Debug,"Sending negotiation request: "+a+"."),d.label=3;case 3:return d.trys.push([3,5,,6]),[4,this.httpClient.post(a,{content:"",headers:Me({},e,this.options.headers),withCredentials:this.options.withCredentials})];case 4:return 200!==(u=d.sent()).statusCode?[2,Promise.reject(new Error("Unexpected status code returned from negotiate '"+u.statusCode+"'"))]:((!(s=JSON.parse(u.content)).negotiateVersion||s.negotiateVersion<1)&&(s.connectionToken=s.connectionId),[2,s]);case 5:return h=d.sent(),this.logger.log(l.Error,"Failed to complete negotiation with the server: "+h),[2,Promise.reject(h)];case 6:return[2]}})})},n.prototype.createConnectUrl=function(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+"id="+e:t},n.prototype.createTransport=function(t,e,o,i){return x(this,void 0,void 0,function(){var r,c,u,s,h,d,g,C,E;return P(this,function(p){switch(p.label){case 0:return r=this.createConnectUrl(t,o.connectionToken),this.isITransport(e)?(this.logger.log(l.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=e,[4,this.startTransport(r,i)]):[3,2];case 1:return p.sent(),this.connectionId=o.connectionId,[2];case 2:c=[],u=o,s=0,h=o.availableTransports||[],p.label=3;case 3:return s<h.length?(g=this.resolveTransportOrError(d=h[s],e,i))instanceof Error?(c.push(d.transport+" failed: "+g),[3,12]):[3,4]:[3,13];case 4:if(!this.isITransport(g))return[3,12];if(this.transport=g,u)return[3,9];p.label=5;case 5:return p.trys.push([5,7,,8]),[4,this.getNegotiationResponse(t)];case 6:return u=p.sent(),[3,8];case 7:return C=p.sent(),[2,Promise.reject(C)];case 8:r=this.createConnectUrl(t,u.connectionToken),p.label=9;case 9:return p.trys.push([9,11,,12]),[4,this.startTransport(r,i)];case 10:return p.sent(),this.connectionId=u.connectionId,[2];case 11:return E=p.sent(),this.logger.log(l.Error,"Failed to start the transport '"+d.transport+"': "+E),u=void 0,c.push(d.transport+" failed: "+E),"Connecting"!==this.connectionState?(this.logger.log(l.Debug,"Failed to select transport before stop() was called."),[2,Promise.reject(new Error("Failed to select transport before stop() was called."))]):[3,12];case 12:return s++,[3,3];case 13:return c.length>0?[2,Promise.reject(new Error("Unable to connect to the server with any of the available transports. "+c.join(" ")))]:[2,Promise.reject(new Error("None of the transports supported by the client are supported by the server."))]}})})},n.prototype.constructTransport=function(t){switch(t){case w.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Ze(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket,this.options.headers||{});case w.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new je(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource,this.options.withCredentials,this.options.headers||{});case w.LongPolling:return new te(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.withCredentials,this.options.headers||{});default:throw new Error("Unknown transport: "+t+".")}},n.prototype.startTransport=function(t,e){var o=this;return this.transport.onreceive=this.onreceive,this.transport.onclose=function(i){return o.stopConnection(i)},this.transport.connect(t,e)},n.prototype.resolveTransportOrError=function(t,e,o){var i=w[t.transport];if(null==i)return this.logger.log(l.Debug,"Skipping transport '"+t.transport+"' because it is not supported by this client."),new Error("Skipping transport '"+t.transport+"' because it is not supported by this client.");if(!function(n,t){return!n||0!=(t&n)}(e,i))return this.logger.log(l.Debug,"Skipping transport '"+w[i]+"' because it was disabled by the client."),new Error("'"+w[i]+"' is disabled by the client.");if(!(t.transferFormats.map(function(c){return S[c]}).indexOf(o)>=0))return this.logger.log(l.Debug,"Skipping transport '"+w[i]+"' because it does not support the requested transfer format '"+S[o]+"'."),new Error("'"+w[i]+"' does not support "+S[o]+".");if(i===w.WebSockets&&!this.options.WebSocket||i===w.ServerSentEvents&&!this.options.EventSource)return this.logger.log(l.Debug,"Skipping transport '"+w[i]+"' because it is not supported in your environment.'"),new Error("'"+w[i]+"' is not supported in your environment.");this.logger.log(l.Debug,"Selecting transport '"+w[i]+"'.");try{return this.constructTransport(i)}catch(c){return c}},n.prototype.isITransport=function(t){return t&&"object"==typeof t&&"connect"in t},n.prototype.stopConnection=function(t){var e=this;if(this.logger.log(l.Debug,"HttpConnection.stopConnection("+t+") called while in state "+this.connectionState+"."),this.transport=void 0,t=this.stopError||t,this.stopError=void 0,"Disconnected"!==this.connectionState){if("Connecting"===this.connectionState)throw this.logger.log(l.Warning,"Call to HttpConnection.stopConnection("+t+") was ignored because the connection is still in the connecting state."),new Error("HttpConnection.stopConnection("+t+") was called while the connection is still in the connecting state.");if("Disconnecting"===this.connectionState&&this.stopPromiseResolver(),t?this.logger.log(l.Error,"Connection disconnected with error '"+t+"'."):this.logger.log(l.Information,"Connection disconnected."),this.sendQueue&&(this.sendQueue.stop().catch(function(o){e.logger.log(l.Error,"TransportSendQueue.stop() threw error '"+o+"'.")}),this.sendQueue=void 0),this.connectionId=void 0,this.connectionState="Disconnected",this.connectionStarted){this.connectionStarted=!1;try{this.onclose&&this.onclose(t)}catch(o){this.logger.log(l.Error,"HttpConnection.onclose("+t+") threw error '"+o+"'.")}}}else this.logger.log(l.Debug,"Call to HttpConnection.stopConnection("+t+") was ignored because the connection is already in the disconnected state.")},n.prototype.resolveUrl=function(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if(!k.isBrowser||!window.document)throw new Error("Cannot resolve '"+t+"'.");var e=window.document.createElement("a");return e.href=t,this.logger.log(l.Information,"Normalizing '"+t+"' to '"+e.href+"'."),e.href},n.prototype.resolveNegotiateUrl=function(t){var e=t.indexOf("?"),o=t.substring(0,-1===e?t.length:e);return"/"!==o[o.length-1]&&(o+="/"),o+="negotiate",-1===(o+=-1===e?"":t.substring(e)).indexOf("negotiateVersion")&&(o+=-1===e?"?":"&",o+="negotiateVersion="+this.negotiateVersion),o},n}(),Fe=function(){function n(t){this.transport=t,this.buffer=[],this.executing=!0,this.sendBufferedData=new Z,this.transportResult=new Z,this.sendLoopPromise=this.sendLoop()}return n.prototype.send=function(t){return this.bufferData(t),this.transportResult||(this.transportResult=new Z),this.transportResult.promise},n.prototype.stop=function(){return this.executing=!1,this.sendBufferedData.resolve(),this.sendLoopPromise},n.prototype.bufferData=function(t){if(this.buffer.length&&typeof this.buffer[0]!=typeof t)throw new Error("Expected data to be of type "+typeof this.buffer+" but was of type "+typeof t);this.buffer.push(t),this.sendBufferedData.resolve()},n.prototype.sendLoop=function(){return x(this,void 0,void 0,function(){var t,e,o;return P(this,function(i){switch(i.label){case 0:return[4,this.sendBufferedData.promise];case 1:if(i.sent(),!this.executing)return this.transportResult&&this.transportResult.reject("Connection stopped."),[3,6];this.sendBufferedData=new Z,t=this.transportResult,this.transportResult=void 0,e="string"==typeof this.buffer[0]?this.buffer.join(""):n.concatBuffers(this.buffer),this.buffer.length=0,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.transport.send(e)];case 3:return i.sent(),t.resolve(),[3,5];case 4:return o=i.sent(),t.reject(o),[3,5];case 5:return[3,0];case 6:return[2]}})})},n.concatBuffers=function(t){for(var e=t.map(function(u){return u.byteLength}).reduce(function(u,s){return u+s}),o=new Uint8Array(e),i=0,r=0,c=t;r<c.length;r++){var a=c[r];o.set(new Uint8Array(a),i),i+=a.byteLength}return o.buffer},n}(),Z=function(){function n(){var t=this;this.promise=new Promise(function(e,o){var i;return t.resolver=(i=[e,o])[0],t.rejecter=i[1],i})}return n.prototype.resolve=function(){this.resolver()},n.prototype.reject=function(t){this.rejecter(t)},n}(),Xe=function(){function n(){this.name="json",this.version=1,this.transferFormat=S.Text}return n.prototype.parseMessages=function(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=q.instance);for(var i=[],r=0,c=R.parse(t);r<c.length;r++){var u=JSON.parse(c[r]);if("number"!=typeof u.type)throw new Error("Invalid payload.");switch(u.type){case v.Invocation:this.isInvocationMessage(u);break;case v.StreamItem:this.isStreamItemMessage(u);break;case v.Completion:this.isCompletionMessage(u);break;case v.Ping:case v.Close:break;default:e.log(l.Information,"Unknown message type '"+u.type+"' ignored.");continue}i.push(u)}return i},n.prototype.writeMessage=function(t){return R.write(JSON.stringify(t))},n.prototype.isInvocationMessage=function(t){this.assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this.assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")},n.prototype.isStreamItemMessage=function(t){if(this.assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")},n.prototype.isCompletionMessage=function(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this.assertNotEmptyString(t.error,"Invalid payload for Completion message."),this.assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")},n.prototype.assertNotEmptyString=function(t,e){if("string"!=typeof t||""===t)throw new Error(e)},n}(),ie=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},qe={trace:l.Trace,debug:l.Debug,info:l.Information,information:l.Information,warn:l.Warning,warning:l.Warning,error:l.Error,critical:l.Critical,none:l.None},Qe=function(){function n(){}return n.prototype.configureLogging=function(t){if(m.isRequired(t,"logging"),function(n){return void 0!==n.log}(t))this.logger=t;else if("string"==typeof t){var e=function(n){var t=qe[n.toLowerCase()];if(void 0!==t)return t;throw new Error("Unknown log level: "+n)}(t);this.logger=new W(e)}else this.logger=new W(t);return this},n.prototype.withUrl=function(t,e){return m.isRequired(t,"url"),m.isNotEmpty(t,"url"),this.url=t,this.httpConnectionOptions=ie({},this.httpConnectionOptions,"object"==typeof e?e:{transport:e}),this},n.prototype.withHubProtocol=function(t){return m.isRequired(t,"protocol"),this.protocol=t,this},n.prototype.withAutomaticReconnect=function(t){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=t?Array.isArray(t)?new $(t):t:new $,this},n.prototype.build=function(){var t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var e=new Le(this.url,t);return Ae.create(e,this.logger||q.instance,this.protocol||new Xe,this.reconnectPolicy)},n}(),I=T(3679),ze=T(2340),f=T(7716),Q=T(8295),Ke=T(9983),Ye=T(1095),$e=T(6627),et=T(1769);function tt(n,t){1&n&&(f.TgZ(0,"mat-error"),f._uU(1,"required"),f.qZA())}function nt(n,t){1&n&&(f.TgZ(0,"mat-error"),f._uU(1,"required"),f.qZA())}function rt(n,t){if(1&n&&(f.TgZ(0,"tr"),f.TgZ(1,"td"),f._uU(2),f.qZA(),f.TgZ(3,"td"),f._uU(4),f.qZA(),f.qZA()),2&n){const e=t.$implicit,o=t.index;f.xp6(2),f.Oqu(o+1),f.xp6(2),f.Oqu(e)}}function ot(n,t){if(1&n&&(f.TgZ(0,"div",1),f.TgZ(1,"div",10),f.TgZ(2,"table",11),f.TgZ(3,"thead"),f.TgZ(4,"tr"),f.TgZ(5,"th"),f._uU(6,"#"),f.qZA(),f.TgZ(7,"th"),f._uU(8,"Messages"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(9,"tbody"),f.YNc(10,rt,5,2,"tr",12),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&n){const e=f.oxw();f.xp6(10),f.Q6J("ngForOf",e.messages)}}function it(n,t){1&n&&(f.TgZ(0,"div",1),f.TgZ(1,"span"),f._uU(2,"No messages"),f.qZA(),f.qZA())}const st=[{path:"",component:(()=>{class n{constructor(e){this.content="",this.messages=[],this.chatForm=e.group({name:["",[I.kI.required,I.kI.minLength(6)]],message:["",[I.kI.required,I.kI.minLength(1)]]})}sendMessage(){this._hubConnection&&this._hubConnection.invoke("SendMessage",this.f.name.value,this.f.message.value),console.log(JSON.stringify(this.chatForm.value,null,2)),this.f.message.patchValue("")}ngOnInit(){this._hubConnection=(new Qe).withUrl(ze.N.chatHub).configureLogging(l.Information).build(),this._hubConnection.start().catch(e=>console.error(e.toString())),this._hubConnection.on("ReceiveMessage",(e,o)=>{this.messages.push(`${e}: ${o}`)})}get f(){return this.chatForm.controls}}return n.\u0275fac=function(e){return new(e||n)(f.Y36(I.qu))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-chathome"]],decls:27,vars:6,consts:[[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-4"],["matInput","","formControlName","name"],[4,"ngIf"],["matInput","","formControlName","message"],[1,"col-2"],["mat-button","","color","primary","type","submit",3,"disabled"],[1,"bi","bi-telegram"],["class","row",4,"ngIf"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"]],template:function(e,o){1&e&&(f.TgZ(0,"form",0),f.NdJ("ngSubmit",function(){return o.sendMessage()}),f.TgZ(1,"fieldset"),f.TgZ(2,"div",1),f._uU(3,"\xa0"),f.qZA(),f.TgZ(4,"div",1),f.TgZ(5,"mat-form-field",2),f.TgZ(6,"mat-label"),f._uU(7,"User"),f.qZA(),f._UZ(8,"input",3),f.YNc(9,tt,2,0,"mat-error",4),f.qZA(),f.qZA(),f.TgZ(10,"div",1),f.TgZ(11,"mat-form-field",2),f.TgZ(12,"mat-label"),f._uU(13,"Message"),f.qZA(),f._UZ(14,"input",5),f.YNc(15,nt,2,0,"mat-error",4),f.qZA(),f.TgZ(16,"div",6),f.TgZ(17,"button",7),f.TgZ(18,"mat-icon"),f._uU(19,"send"),f.qZA(),f.qZA(),f._UZ(20,"i",8),f.qZA(),f.qZA(),f.TgZ(21,"div",1),f._uU(22,"\xa0"),f.qZA(),f.qZA(),f.qZA(),f._UZ(23,"div",1),f._UZ(24,"mat-divider"),f.YNc(25,ot,11,1,"div",9),f.YNc(26,it,3,0,"div",9)),2&e&&(f.Q6J("formGroup",o.chatForm),f.xp6(9),f.Q6J("ngIf",o.f.name.invalid),f.xp6(6),f.Q6J("ngIf",o.f.message.invalid),f.xp6(2),f.Q6J("disabled",o.chatForm.invalid),f.xp6(8),f.Q6J("ngIf",o.messages.length>0),f.xp6(1),f.Q6J("ngIf",o.messages.length<=0))},directives:[I._Y,I.JL,I.sg,Q.KE,Q.hX,Ke.Nt,I.Fj,I.JJ,I.u,L.O5,Ye.lW,$e.Hw,et.d,Q.TO,L.sg],styles:[""]}),n})()}];let ct=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[[z.Bz.forChild(st)],z.Bz]}),n})();var at=T(3573);let ut=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[[L.ez,ct,at.l,I.UX]]}),n})()}}]);